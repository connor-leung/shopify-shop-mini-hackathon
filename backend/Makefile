.PHONY: help dev prod stop build logs clean

# Default target
help:
	@echo "ðŸŽ® Shop Mini Games Backend"
	@echo "=========================="
	@echo ""
	@echo "Available commands:"
	@echo "  make dev     - Start in development mode (hot reload)"
	@echo "  make prod    - Start in production mode"
	@echo "  make stop    - Stop all services"
	@echo "  make build   - Build and start in background"
	@echo "  make logs    - Show service logs"
	@echo "  make clean   - Stop services and remove volumes"
	@echo ""

# Development mode with hot reload
dev:
	@echo "ðŸ”§ Starting in development mode..."
	docker-compose -f docker-compose.dev.yml up --build

# Production mode
prod:
	@echo "ðŸš€ Starting in production mode..."
	docker-compose up --build -d
	@echo "âœ… Services started!"
	@echo "ðŸ“– API Documentation: http://localhost:8000/docs"
	@echo "ðŸ” Health Check: http://localhost:8000/health"

# Stop all services
stop:
	@echo "ðŸ›‘ Stopping services..."
	docker-compose -f docker-compose.yml down 2>/dev/null || true
	docker-compose -f docker-compose.dev.yml down 2>/dev/null || true
	@echo "âœ… Services stopped"

# Build and start in background
build:
	@echo "ðŸ”¨ Building and starting services..."
	docker-compose -f docker-compose.dev.yml up --build -d
	@echo "âœ… Services started in background!"
	@echo "ðŸ“– API Documentation: http://localhost:8000/docs"

# Show logs
logs:
	@echo "ðŸ“‹ Showing logs..."
	docker-compose -f docker-compose.dev.yml logs -f

# Clean up everything
clean:
	@echo "ðŸ§¹ Cleaning up..."
	docker-compose -f docker-compose.yml down -v 2>/dev/null || true
	docker-compose -f docker-compose.dev.yml down -v 2>/dev/null || true
	docker system prune -f
	@echo "âœ… Cleanup complete"